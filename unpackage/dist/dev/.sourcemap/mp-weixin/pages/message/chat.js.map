{"version":3,"file":"chat.js","sources":["pages/message/chat.vue","../../hbuildx/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWVzc2FnZS9jaGF0LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view class=\"chat-list\">\r\n\t\t\t<view class=\"chat-item\" :class=\"{ self: item.senderId !== currentUserId }\" \r\n\t\t\t\tv-for=\"item in chatMessages\" :key=\"item.id\">\r\n\t\t\t\t<image v-if=\"item.senderId === currentUserId\" class=\"avatar\" \r\n\t\t\t\t\t:src=\"userAvatar\" mode=\"aspectFill\"></image>\r\n\t\t\t\t<view class=\"message-bubble\">\r\n\t\t\t\t\t<text class=\"message-text\">{{ item.content }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<image v-if=\"item.senderId !== currentUserId\" class=\"avatar\" \r\n\t\t\t\t\t:src=\"targetAvatar\" mode=\"aspectFill\"></image>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 输入栏 -->\r\n\t\t<view class=\"input-bar\">\r\n\t\t\t<input class=\"input\" v-model=\"inputText\" placeholder=\"输入消息...\" @confirm=\"sendMessage\" />\r\n\t\t\t<view class=\"send-btn\" @click=\"sendMessage\">\r\n\t\t\t\t<uni-icons type=\"paperplane\" size=\"24\" color=\"#007AFF\"></uni-icons>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport { getChatMessages, getUserInfo } from '@/utils/mockData.js'\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tuserId: '',\r\n\t\t\tcurrentUserId: 0, // 当前登录用户ID\r\n\t\t\tchatMessages: [],\r\n\t\t\tinputText: '',\r\n\t\t\tuserAvatar: 'https://via.placeholder.com/100',\r\n\t\t\ttargetAvatar: 'https://via.placeholder.com/100'\r\n\t\t}\r\n\t},\r\n\tonLoad(options) {\r\n\t\tif (options.userId) {\r\n\t\t\tthis.userId = options.userId\r\n\t\t\tthis.loadChat()\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tloadChat() {\r\n\t\t\t// 加载聊天记录\r\n\t\t\tthis.chatMessages = getChatMessages(this.userId)\r\n\t\t\t\r\n\t\t\t// 加载用户头像\r\n\t\t\tconst user = getUserInfo(this.userId)\r\n\t\t\tif (user) {\r\n\t\t\t\tthis.targetAvatar = user.avatar\r\n\t\t\t}\r\n\t\t},\r\n\t\tsendMessage() {\r\n\t\t\tif (!this.inputText.trim()) return\r\n\t\t\t\r\n\t\t\tconst newMessage = {\r\n\t\t\t\tid: this.chatMessages.length + 1,\r\n\t\t\t\tsenderId: this.currentUserId,\r\n\t\t\t\tcontent: this.inputText,\r\n\t\t\t\ttime: new Date().toLocaleString()\r\n\t\t\t}\r\n\t\t\tthis.chatMessages.push(newMessage)\r\n\t\t\tthis.inputText = ''\r\n\t\t\t\r\n\t\t\t// 滚动到底部\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\tscrollTop: 99999,\r\n\t\t\t\t\tduration: 300\r\n\t\t\t\t})\r\n\t\t\t}, 100)\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n\tmin-height: 100vh;\r\n\tbackground-color: #F5F5F5;\r\n\tpadding-bottom: 120rpx;\r\n}\r\n\r\n.chat-list {\r\n\tpadding: 20rpx;\r\n}\r\n\r\n.chat-item {\r\n\tdisplay: flex;\r\n\talign-items: flex-start;\r\n\tmargin-bottom: 30rpx;\r\n}\r\n\r\n.chat-item.self {\r\n\tflex-direction: row-reverse;\r\n}\r\n\r\n.avatar {\r\n\twidth: 60rpx;\r\n\theight: 60rpx;\r\n\tborder-radius: 50%;\r\n\tmargin: 0 20rpx;\r\n}\r\n\r\n.message-bubble {\r\n\tmax-width: 60%;\r\n\tbackground-color: #fff;\r\n\tborder-radius: 10rpx;\r\n\tpadding: 20rpx;\r\n\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.chat-item.self .message-bubble {\r\n\tbackground-color: #007AFF;\r\n}\r\n\r\n.message-text {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333;\r\n\tline-height: 1.5;\r\n}\r\n\r\n.chat-item.self .message-text {\r\n\tcolor: #fff;\r\n}\r\n\r\n.input-bar {\r\n\tposition: fixed;\r\n\tbottom: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tbackground-color: #fff;\r\n\tpadding: 20rpx;\r\n\tborder-top: 1rpx solid #eee;\r\n\tz-index: 999;\r\n}\r\n\r\n.input {\r\n\tflex: 1;\r\n\theight: 70rpx;\r\n\tbackground-color: #F5F5F5;\r\n\tborder-radius: 35rpx;\r\n\tpadding: 0 30rpx;\r\n\tfont-size: 28rpx;\r\n\tmargin-right: 20rpx;\r\n}\r\n\r\n.send-btn {\r\n\twidth: 70rpx;\r\n\theight: 70rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n}\r\n</style>\r\n\r\n\r\n\r\n\r\n\r\n","import MiniProgramPage from 'G:/小程序xycy页面/SkyMark/pages/message/chat.vue'\nwx.createPage(MiniProgramPage)"],"names":["getChatMessages","getUserInfo","uni"],"mappings":";;;AA4BA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,QAAQ;AAAA,MACR,eAAe;AAAA;AAAA,MACf,cAAc,CAAE;AAAA,MAChB,WAAW;AAAA,MACX,YAAY;AAAA,MACZ,cAAc;AAAA,IACf;AAAA,EACA;AAAA,EACD,OAAO,SAAS;AACf,QAAI,QAAQ,QAAQ;AACnB,WAAK,SAAS,QAAQ;AACtB,WAAK,SAAS;AAAA,IACf;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,WAAW;AAEV,WAAK,eAAeA,+BAAgB,KAAK,MAAM;AAG/C,YAAM,OAAOC,eAAAA,YAAY,KAAK,MAAM;AACpC,UAAI,MAAM;AACT,aAAK,eAAe,KAAK;AAAA,MAC1B;AAAA,IACA;AAAA,IACD,cAAc;AACb,UAAI,CAAC,KAAK,UAAU,KAAM;AAAE;AAE5B,YAAM,aAAa;AAAA,QAClB,IAAI,KAAK,aAAa,SAAS;AAAA,QAC/B,UAAU,KAAK;AAAA,QACf,SAAS,KAAK;AAAA,QACd,OAAM,oBAAI,KAAM,GAAC,eAAe;AAAA,MACjC;AACA,WAAK,aAAa,KAAK,UAAU;AACjC,WAAK,YAAY;AAGjB,iBAAW,MAAM;AAChBC,sBAAAA,MAAI,aAAa;AAAA,UAChB,WAAW;AAAA,UACX,UAAU;AAAA,SACV;AAAA,MACD,GAAE,GAAG;AAAA,IACP;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5EA,GAAG,WAAW,eAAe;"}