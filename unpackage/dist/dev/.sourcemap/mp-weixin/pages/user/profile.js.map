{"version":3,"file":"profile.js","sources":["pages/user/profile.vue","../../hbuildx/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9wcm9maWxlLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<!-- Áî®Êà∑‰ø°ÊÅØ -->\n\t\t<view class=\"user-header\">\n\t\t\t<view class=\"avatar-wrapper\" @click=\"goToEdit\">\n\t\t\t\t<image class=\"avatar\" :src=\"userInfo.avatar || '/static/default-avatar.png'\" mode=\"aspectFill\"></image>\n\t\t\t\t<view class=\"avatar-edit-hint\">ÁÇπÂáªÁºñËæë</view>\n\t\t\t</view>\n\t\t\t<view class=\"user-info\" @click=\"goToEdit\">\n\t\t\t\t<text class=\"username\">{{ userInfo.username }}</text>\n\t\t\t\t<text class=\"user-level\">{{ userInfo.level }}</text>\n\t\t\t</view>\n\t\t\t<text class=\"arrow-icon\" @click=\"goToEdit\">‚Ä∫</text>\n\t\t</view>\n\t\t\n\t\t<!-- Êï∞ÊçÆÁªüËÆ° -->\n\t\t<view class=\"stats\">\n\t\t\t<view class=\"stat-item\" @click=\"goToMyGoods\">\n\t\t\t\t<text class=\"stat-value\">{{ myGoodsCount }}</text>\n\t\t\t\t<text class=\"stat-label\">ÊàëÁöÑÂïÜÂìÅ</text>\n\t\t\t</view>\n\t\t\t<view class=\"stat-item\" @click=\"goToFavorites\">\n\t\t\t\t<text class=\"stat-value\">{{ favoritesCount }}</text>\n\t\t\t\t<text class=\"stat-label\">ÊàëÁöÑÊî∂Ëóè</text>\n\t\t\t</view>\n\t\t\t<view class=\"stat-item\" @click=\"goToOrders\">\n\t\t\t\t<text class=\"stat-value\">{{ ordersCount }}</text>\n\t\t\t\t<text class=\"stat-label\">ÊàëÁöÑËÆ¢Âçï</text>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- ÂäüËÉΩÂàóË°® -->\n\t\t<view class=\"menu-list\">\n\t\t\t<view class=\"menu-item\" @click=\"goToOrders\">\n\t\t\t\t<text class=\"menu-icon\">üõí</text>\n\t\t\t\t<text class=\"menu-text\">ÊàëÁöÑËÆ¢Âçï</text>\n\t\t\t\t<text class=\"menu-arrow\">‚Ä∫</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"goToMyGoods\">\n\t\t\t\t<text class=\"menu-icon\">üì¶</text>\n\t\t\t\t<text class=\"menu-text\">ÊàëÁöÑÂïÜÂìÅ</text>\n\t\t\t\t<text class=\"menu-arrow\">‚Ä∫</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"goToFavorites\">\n\t\t\t\t<text class=\"menu-icon\">‚ù§Ô∏è</text>\n\t\t\t\t<text class=\"menu-text\">ÊàëÁöÑÊî∂Ëóè</text>\n\t\t\t\t<text class=\"menu-arrow\">‚Ä∫</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"goToAddress\">\n\t\t\t\t<text class=\"menu-icon\">üìç</text>\n\t\t\t\t<text class=\"menu-text\">Âú∞ÂùÄÁÆ°ÁêÜ</text>\n\t\t\t\t<text class=\"menu-arrow\">‚Ä∫</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"goToSettings\">\n\t\t\t\t<text class=\"menu-icon\">‚öôÔ∏è</text>\n\t\t\t\t<text class=\"menu-text\">ËÆæÁΩÆ</text>\n\t\t\t\t<text class=\"menu-arrow\">‚Ä∫</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"goToHelp\">\n\t\t\t\t<text class=\"menu-icon\">‚ùì</text>\n\t\t\t\t<text class=\"menu-text\">Â∏ÆÂä©‰∏≠ÂøÉ</text>\n\t\t\t\t<text class=\"menu-arrow\">‚Ä∫</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"goToFeedback\">\n\t\t\t\t<text class=\"menu-icon\">üí¨</text>\n\t\t\t\t<text class=\"menu-text\">ÊÑèËßÅÂèçÈ¶à</text>\n\t\t\t\t<text class=\"menu-arrow\">‚Ä∫</text>\n\t\t\t</view>\n\t\t\t<view class=\"menu-item\" @click=\"goToAbout\">\n\t\t\t\t<text class=\"menu-icon\">‚ÑπÔ∏è</text>\n\t\t\t\t<text class=\"menu-text\">ÂÖ≥‰∫éÊàë‰ª¨</text>\n\t\t\t\t<text class=\"menu-arrow\">‚Ä∫</text>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- ÈÄÄÂá∫ÁôªÂΩïÊåâÈíÆ -->\n\t\t<view class=\"logout-section\">\n\t\t\t<button class=\"logout-btn\" @click=\"handleLogout\">ÈÄÄÂá∫ÁôªÂΩï</button>\n\t\t</view>\n\t</view>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport { onLoad, onShow } from '@dcloudio/uni-app'\nimport { userApi, goodsApi, orderApi,favoriteApi } from '@/utils/apiService.js'\nimport { getCurrentUser, getCurrentUserId, checkLogin, logout, isLoggedIn } from '@/utils/auth.js'\n\nconst userInfo = ref({\n\tid: null,\n\tusername: 'Êú™ÁôªÂΩï',\n\tavatar: '',\n\tlevel: 'V1',\n\tscore: 0,\n\tphone: '',\n\temail: '',\n\taddress: ''\n})\n\nconst myGoodsCount = ref(0)\nconst favoritesCount = ref(0)\nconst ordersCount = ref(0)\n\nasync function loadData() {\n\t// Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ\n\tif (!isLoggedIn()) {\n\t\tuserInfo.value = {\n\t\t\tid: null,\n\t\t\tusername: 'Êú™ÁôªÂΩï',\n\t\t\tavatar: 'https://i.pravatar.cc/100?img=0',\n\t\t\tlevel: 'V1',\n\t\t\tscore: 0,\n\t\t\tphone: '',\n\t\t\temail: '',\n\t\t\taddress: ''\n\t\t}\n\t\tmyGoodsCount.value = 0\n\t\tfavoritesCount.value = 0\n\t\tordersCount.value = 0\n\t\treturn\n\t}\n\t\n\ttry {\n\t\tconst userId = getCurrentUserId()\n\t\tif (!userId) {\n\t\t\treturn\n\t\t}\n\t\t\n\t\t// Âä†ËΩΩÁî®Êà∑‰ø°ÊÅØ\n\t\tconst currentUser = getCurrentUser()\n\t\tif (currentUser) {\n\t\t\tuserInfo.value = { ...currentUser }\n\t\t\t\n\t\t\t// ‰ªéÊúçÂä°Âô®Ëé∑ÂèñÊúÄÊñ∞Áî®Êà∑‰ø°ÊÅØ\n\t\t\ttry {\n\t\t\t\tconst userData = await userApi.getUserInfo(userId)\n\t\t\t\tif (userData) {\n\t\t\t\t\tuserInfo.value = { ...userData }\n\t\t\t\t\t// Êõ¥Êñ∞Êú¨Âú∞Â≠òÂÇ®\n\t\t\t\t\tuni.setStorageSync('userInfo', userData)\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:', error)\n\t\t\t}\n\t\t}\n\t\t\n\t\t// ÁªüËÆ°Êï∞ÊçÆ\n\t\ttry {\n\t\t\t// ÊàëÁöÑÂïÜÂìÅÊï∞Èáè\n\t\t\tconst myGoods = await goodsApi.getMyGoods(userId)\n\t\t\tmyGoodsCount.value = Array.isArray(myGoods) ? myGoods.length : 0\n\t\t} catch (error) {\n\t\t\tconsole.error('Ëé∑ÂèñÊàëÁöÑÂïÜÂìÅÂ§±Ë¥•:', error)\n\t\t}\n\t\t\n\t\ttry {\n\t\t\t// ËÆ¢ÂçïÊï∞Èáè\n\t\t\tconst orders = await orderApi.getOrderList(userId)\n\t\t\tordersCount.value = Array.isArray(orders) ? orders.length : 0\n\t\t} catch (error) {\n\t\t\tconsole.error('Ëé∑ÂèñËÆ¢ÂçïÂàóË°®Â§±Ë¥•:', error)\n\t\t}\n\t\t\n\t\ttry {\n\t\t\tconst count = await favoriteApi.getFavoriteCount(userId)\n\t\t\tfavoritesCount.value = count || 0\n\t\t} catch (error) {\n\t\t\tconsole.error('Ëé∑ÂèñÊî∂ËóèÊï∞ÈáèÂ§±Ë¥•:', error)\n\t\t\tfavoritesCount.value = 0\n\t\t}\n\t\t\n\t} catch (error) {\n\t\tconsole.error('Âä†ËΩΩÊï∞ÊçÆÂ§±Ë¥•:', error)\n\t}\n}\n\nfunction handleLogout() {\n\tlogout()\n}\n\nonLoad(() => {\n\tloadData()\n})\n\nonShow(() => {\n\tloadData()\n})\n\n// ÂØºÂá∫ÊñπÊ≥ï‰æõÊ®°Êùø‰ΩøÁî®\nconst goToEdit = () => {\n\tif (!checkLogin()) return\n\t// Ë∑≥ËΩ¨Âà∞ÁºñËæëÈ°µÈù¢\n\tuni.navigateTo({ url: '/pages/user/updata' })\n}\n\nconst goToMyGoods = () => {\n\tif (!checkLogin()) return\n\tuni.navigateTo({ url: '/pages/goods/my' })\n}\n\nconst goToFavorites = () => {\n\tif (!checkLogin()) return\n\tuni.navigateTo({ url: '/pages/user/favorites' })\n}\n\nconst goToOrders = () => {\n\tif (!checkLogin()) return\n\tuni.navigateTo({ url: '/pages/order/list' })\n}\n\nconst goToAddress = () => {\n\tif (!checkLogin()) return\n\tuni.navigateTo({ url: '/pages/address/list' })\n}\n\nconst goToSettings = () => {\n\tuni.navigateTo({ url: '/pages/settings/index' })\n}\n\nconst goToHelp = () => {\n\tuni.navigateTo({ url: '/pages/help/index' })\n}\n\nconst goToFeedback = () => {\n\tuni.navigateTo({ url: '/pages/feedback/index' })\n}\n\nconst goToAbout = () => {\n\tuni.navigateTo({ url: '/pages/about/index' })\n}\n</script>\n\n<style scoped>\n.container {\n\tmin-height: 100vh;\n\tbackground-color: #F5F5F5;\n}\n\n.user-header {\n\tdisplay: flex;\n\talign-items: center;\n\tbackground-color: #007AFF;\n\tpadding: 60rpx 40rpx 40rpx;\n\tcolor: #fff;\n}\n\n.avatar-wrapper {\n\tposition: relative;\n\tmargin-right: 30rpx;\n}\n\n.avatar {\n\twidth: 120rpx;\n\theight: 120rpx;\n\tborder-radius: 50%;\n\tborder: 4rpx solid rgba(255, 255, 255, 0.3);\n}\n\n.avatar-edit-hint {\n\tposition: absolute;\n\tbottom: 0;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\tbackground-color: rgba(0, 0, 0, 0.6);\n\tcolor: #fff;\n\tfont-size: 20rpx;\n\tpadding: 4rpx 12rpx;\n\tborder-radius: 20rpx;\n\twhite-space: nowrap;\n\topacity: 0;\n\ttransition: opacity 0.3s;\n}\n\n.avatar-wrapper:active .avatar-edit-hint {\n\topacity: 1;\n}\n\n.user-info {\n\tflex: 1;\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.username {\n\tfont-size: 36rpx;\n\tfont-weight: bold;\n\tmargin-bottom: 10rpx;\n}\n\n.user-level {\n\tfont-size: 24rpx;\n\topacity: 0.8;\n}\n\n.arrow-icon {\n\tfont-size: 32rpx;\n\tcolor: #999;\n\tfont-weight: bold;\n}\n\n.stats {\n\tdisplay: flex;\n\tbackground-color: #fff;\n\tmargin: -30rpx 40rpx 20rpx;\n\tborder-radius: 20rpx;\n\tpadding: 40rpx 0;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.1);\n}\n\n.stat-item {\n\tflex: 1;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n}\n\n.stat-value {\n\tfont-size: 40rpx;\n\tfont-weight: bold;\n\tcolor: #007AFF;\n\tmargin-bottom: 10rpx;\n}\n\n.stat-label {\n\tfont-size: 24rpx;\n\tcolor: #999;\n}\n\n.menu-list {\n\tbackground-color: #fff;\n\tmargin: 0 20rpx;\n\tborder-radius: 20rpx;\n\toverflow: hidden;\n}\n\n.menu-item {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 30rpx;\n\tborder-bottom: 1rpx solid #F5F5F5;\n}\n\n.menu-item:last-child {\n\tborder-bottom: none;\n}\n\n.menu-icon {\n\tfont-size: 24rpx;\n\tmargin-right: 20rpx;\n}\n\n.menu-text {\n\tflex: 1;\n\tfont-size: 28rpx;\n\tcolor: #333;\n\tmargin-left: 0;\n}\n\n.menu-arrow {\n\tfont-size: 24rpx;\n\tcolor: #999;\n\tfont-weight: bold;\n}\n\n.logout-section {\n\tpadding: 40rpx 20rpx;\n\tmargin-top: 40rpx;\n}\n\n.logout-btn {\n\twidth: 100%;\n\theight: 88rpx;\n\tbackground-color: #fff;\n\tcolor: #FF3B30;\n\tborder: 2rpx solid #FF3B30;\n\tborder-radius: 20rpx;\n\tfont-size: 32rpx;\n\tline-height: 88rpx;\n\ttext-align: center;\n}\n\n.logout-btn:active {\n\tbackground-color: #FFEBE9;\n}\n</style>\n\n\n\n\n\n","import MiniProgramPage from 'G:/Â∞èÁ®ãÂ∫èxycyÈ°µÈù¢/SkyMark/pages/user/profile.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","isLoggedIn","getCurrentUserId","getCurrentUser","userApi","uni","goodsApi","orderApi","favoriteApi","logout","onLoad","onShow","checkLogin"],"mappings":"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"}